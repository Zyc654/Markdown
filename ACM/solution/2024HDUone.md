[2024“钉耙编程”中国大学生算法设计超级联赛（1） - 空気力学の詩 - 博客园 (cnblogs.com)](https://www.cnblogs.com/cjjsb/p/18312365#preface)

[2024“钉耙编程”中国大学生算法设计超级联赛（1） - Luckyblock - 博客园 (cnblogs.com)](https://www.cnblogs.com/luckyblock/p/18312579)

## 1005 博弈

因为是随机取字母，按理说两个平局的概率是一半一半的，但是可能会出现平局的概率，此时要减去平局的概率之后才是 A 获胜的概率

对于 sum 是偶数的情况，如果可以出现平局的概率代表此时一定是两人每一位选择的都是一样的，即是每个字母都要出现偶数个才能满足，

此时可以通过排列组合求出平局的概率，此时胜利的概率就是 `(1 - p) / 2`，如果有一个字母是奇数，则代表结果是 1 / 2；

对于 sum 是奇数的情况，此时一定不存在平局的情况，如果前面的都相同，但是由于 A 先手，会额外多一位所以此时 A 胜利，所以若前 n - 1 位都相同概率为 p ，则 A 获胜的概率是 `(1 + p) / 2`

---

## 1003 树

[Problem - 7435 (hdu.edu.cn)](https://acm.hdu.edu.cn/showproblem.php?pid=7435)

如果向当前线段树中加入 一个 x 的话，对于树中的每个数，如果 y < x，则对答案的贡献是 `x * (x - y) 即是`$x ^ 2 - x * y$ (此时 y < x)，也即是 `比 x 小的个数* x的平方减去 x * (比 x 小的数和)`，对于 y > x，对答案的贡献是 y * (x - y)，即是 $x*y - y ^2$，即是需要求出比 x 大的数的和，以及比 x 大的数的平方和

本题相当于是对每一个点都开辟一棵线段树，类似于主席树，所以空间是 `N << 5`，对于一棵子树而言，本题还需要使用权值线段树，区间不是连续的，所以不能使用常规线段树`u << 1 和 u << 1 | 1`来求解左右儿子， 要使用数组来存储左右儿子的编号，即是 `ls[N],rs[N]`的意义，开辟的空间都应该是`N << 5`，线段树维护区间平方和，区间和，区间个数即可，对于两点之间有边的时候，即是满足子树关系时，合并两个线段树，更新当前点的答案。

合并两个树时，`ls[a] = mer(ls[a],ls[b],l,mid)`从叶子向上合并，更新当前根的左右区间，`add`函数相当于 `modify`函数，将`u << 1、u << 1 | 1`的对应位置替换为 `ls[u],rs[u]`，对应的`pushup,pushdown`都是类似的

写权值线段树的时候需要注意如果只是一棵权值线段树，倒是无所谓，每次正常按照线段树找左右儿子即可，但是多棵权值线段树，由于需要动态开点，不是每个权值都被用到了，所以节省空间不能正常寻找左右儿子，需要使用辅助数组`ls[],rs[]`来存储每个点的左右儿子，来判断左区间和右区间的信息，多个线段树一定是`N << 5`。

---

## 1012 并

给定矩形数量并不太多，于是考虑将横纵坐标离散化，有用的坐标数量仅有 $O(n^2) $级别，对它们进行二位前缀和即可快速求出每个区域被多少个矩形覆盖。记 $s_j $表示恰好被 j 个给定矩形覆盖的区域的面积之和。

然后考虑枚举选出的矩形数量 i，再考虑枚举有贡献的区域共被矩形覆盖的数量 j 。显然当 n − j < i 时这样的区域至少会被 i 个矩形中一个覆盖，则贡献即为 $s_j$；当 n − j > i 时，考虑取补集，求这样的区域不被 i 个矩形任意一个覆盖的概率，则期望覆盖面积并 $ans_i$ 为：
$$
a n s_{i}=\sum_{j=1}^{n}\left(1-\frac{{\binom{n-j}{i}}}{{\binom{n}{i}}}\right)\times s_{j}
$$
预处理下杨辉三角即可。总时间复杂度 O(n2) 级别。

```cpp
pre(i,1,szx - 1)
{
    pre(j,1,szy - 1)
    {
        s[i][j] += s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1];//二维前缀和求当前有多少个矩形,相当于容斥原理
        if(s[i][j] >= 1)//
            sum[s[i][j]] = (sum[s[i][j]] + (vex[i + 1] - vex[i]) * (vey[j + 1] - vey[j]) % mod) % mod;//恰好被s[i][j]个矩形覆盖的面积
    }
}
```

## 1006 序列立方

[Problem - 7438 (hdu.edu.cn)](https://acm.hdu.edu.cn/showproblem.php?pid=7438)

求解本质不同的子序列出现次数的立方之和，等价于选择三个子序列使他们相同的方案数。(三个位置每一个位置都有 x 种可以选择，所以方案数数$x^3$，即是目标答案)。

转换为 DP 问题，在一个字符串中任意选择三个子序列使得他们相同的方案数，`f[i][j][k]`表示选择的第一个序列结尾为 `a[i]`，第二个序列结尾是`	a[j]`，第三个序列结尾是`a[k]`时的合法方案数，初始化`f[0][0][0] = 1`，转移时考虑枚举三个子序列各自的前驱，转移方程：

![转移方程](../Images/1006序列立方.png)

答案即为$\sum_{a_{i}=a_{j}=a_{k}}f_{i,j,k},  O(n^6)$ 使用三维前缀和优化 $g_{i j,k}=\sum_{0\leq i^{\prime}\leq i}\sum_{0\leq j^{\prime}\leq j}\sum_{0\leq k^{\prime}\leq k}f_{{i^{\prime}},j^{\prime},k^{\prime}}$

[代码查看](/mine/vsc/HDU/2024 one/序列立方.cpp)



























