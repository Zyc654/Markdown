## J

[2024牛客多校3J Rigged Games_2024牛客多校第三场j-CSDN博客](https://blog.csdn.net/qq_44714797/article/details/140660961)

[代码查看 (nowcoder.com)](https://ac.nowcoder.com/acm/contest/view-submission?submissionId=70561185)

对于每一小局 Bo(2a -1)，可以直接采用双指针判断每一小局结束的情况，复杂度是 $O(n)$ 因为，左指针只会右移。

对于次要比赛处理出来的结果，不能在使用双指针，因为此时的串不是一个循环串，考虑倍增

`jump[N][31]`; 表示从 i 开始进行 $2^j$ 场主要比赛之后的从何处继续比赛

`cnt[N][31][2]` 表示从 i 开始进行 $2^j$ 场主要比赛之后的获胜情况 `cnt[i][j][1]` 表示从 i 开始进行 `2^j`比赛之后获胜方是B，反之是 A

利用倍增来判断从 i 开始进行 $2^j$ 场主要比赛之后一句A、B的获胜情况

```cpp
 pre(j,1,30)//更新倍增
 {
     pre(i,0,n - 1)
     {
         jump[i][j] = jump[jump[i][j - 1]][j - 1];
         cnt[i][j][0] = cnt[i][j - 1][0] + cnt[jump[i][j - 1]][j - 1][0];
         cnt[i][j][1] = cnt[i][j - 1][1] + cnt[jump[i][j - 1]][j - 1][1];
     }
 }
```

从大到小找到最远的 x 使得两人的得分都小于 b ，下一次操作一定会结束当前的一局主要比赛 即是`jump[x][0]`，获胜情况是 `cnt[x][0][1]/[0]`

操作一次之后得到一次主要比赛的答案

一次主要比赛由 `[b,2b-1]`场次要比赛组成，一次次要比赛由 `[a,2a - 1]`场基本比赛构成



