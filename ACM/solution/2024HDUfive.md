## 7484 树论(一)

枚举每一个 `gcd`, 由于 `gcd(x,y) < n` ,且如果 `i,j`的最大公因子为 `g`, 那么 `i , j`一定是 `g`的倍数 , 即是 `i += g,j += g`

同**埃氏筛法**复杂度类似 第二维第三维是 `调和级数`复杂度平均是 `logn`, 且我们只需要处理无序对即可 , 最后判断时直接判断 `i == j`对应结果加 1 或者加 2

这部分复杂度为 $n(logn)^2$

由于每次查询的时以 `x` 为根的子树中的查询 , 所以不难想到需要求子树序列 , 考虑将点对的答案直接加到最近公共祖先上 `LCA(i,j)`

这样即可以解决每次询问对根节点求数量的问题 , 结合 欧拉序 求出子树的信息序列 , 利用树状数组即可 `logn` 的复杂度内求出答案

对于每次询问 , 我们需要离线操作 , 优先向树状数组中加上 `lcm` 较小的点对 , 因为我们要求点对需要符合的条件是`lcm(i,j) <= x` 所以从小到大依次向树状数组中加入 `lcm` 点对的影响 , 这样查询到 `lcm <= x` 时,只需要对一次 `lcm`操作 , 复杂度大大降低 . 

