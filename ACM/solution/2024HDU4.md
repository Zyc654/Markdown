## [$7471-最优 K 子段$](https://acm.hdu.edu.cn/showproblem.php?pid=7471)

神奇的复杂度 ! ! ! ! ! ! ! ! ! ! ! ! ! ! !

由于数据分布随机生成 , 并且质数分布大致随机 , 如果存在找不了多少次便能找到合法的区间 ? ? ? 

最终复杂度大概是 $O(n(logn)^2)$ ? ? ? ? 不会证

预处理出 N 之内所有的质数 , 使用 `埃氏筛` $O(nlgn)$ , 对于每次二分答案 , 考虑按照 $S_{l-1}$ 的大小从小到大枚举所有左端点并依次检验，由于数据随机且质数的分布大致均匀，可以发现如果合法的左端点则不会找太多次就能找到

**注意 : ** 题目中的找到恰好 `k` 段 , 但是可以不必选完 , 所以具有单调性 , 可以二分 

每次二分答案时 , 初始化一个 `set<pii>` 数组表示前缀和数组和数据下标 , 这样只需要当前区间内所有数据之和大于 `x` , 并且当前区间长度是质数对答案则有 1 的贡献 , 否则 `L++` 直至访问到 `st.end()` 

注意计算答案贡献的时候只有 `L != st.end()` 才会有贡献 , 此时并清空 `set` 数组



















